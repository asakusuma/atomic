(function(t,e,undefined){function r(t){var e={exports:{}},r=e.exports,n={title:"Atomic CommonJS Harness"};t.call(e,e,r,n)}function n(){return c._.Bluebird}function i(t,e){return t.className.match(RegExp("(?:^|\\s)"+e.replace(/[^A-Z0-9\-\_]/gi,"-")+"(?!\\S)"))}function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(t,e,r){var n,i,o,a=s(t)?"array":"object",u={},c={},l=function(t,e){return t&&e?l._.set(t,e):t?u[t]:u};if(l.toString=function(){var e,r,n=[];if("object"===a)for(e in t)t.hasOwnProperty(e)&&n.push(e+" ("+(u[e]?"R":"?")+"): "+t[e]);else for(r=0,o=t.length;o>r;r++)n.push("["+r+"] ("+(u[t[r]]?"R":"?")+"): "+t[r]);return n.join("\n")},l._={raw:function(){return t},exists:function(e){if("array"===a){for(var r=0,n=t.length;n>r;r++)if(t[r]===e)return!0;return!1}for(var i in t)if(t.hasOwnProperty(i)&&i===e)return!0;return!1},add:function(){"array"===a?c[arguments[0]]||(c[arguments[0]]=1,t.push(arguments[0]),l._.set(arguments[0],null)):(t[arguments[0]]=arguments[1],e&&(l[arguments[0]]=arguments[0]),r&&(u[arguments[0]]=arguments[0]))},set:function(t,e){u[t]=e}},"object"===a)for(n in t)t.hasOwnProperty(n)&&(l._.set(n,null),e&&(l[n]=n),r&&(u[n]=n));else for(i=0,o=t.length;o>i;i++)l._.set(t[i],null);return l}if(!t.Atomic){var require=null,define=null,a=null;try{a=e()}catch(u){}var c=function(){c.define.apply(c,arguments)};c.Events={},c._={Fiber:null,EventEmitter:null,requires:{},modules:{}},c.config=t.ATOMIC_CONFIG||{},t.Atomic=c,c.augment=function(t,e){if("[object Array]"===Object.prototype.toString.call(t))t=t.concat(e);else for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t};var l=/[^A-Z0-9\-\_]/gi;r(function(t){(function(e){function r(t,e){var r;for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}function Fiber(){}var n=!1,i=Array.prototype,s=e.Fiber;Fiber.extend=function(t){function e(){n||(this.init.apply(this,arguments),this.init=void 0)}var i,s=this.prototype,o=t(s);return n=!0,i=e.prototype=new this,n=!1,i.init=function(){"function"==typeof s.init&&s.init.apply(this,arguments)},r(o,i),i.constructor=e,e.__base__=s,e.extend=Fiber.extend,e},Fiber.proxy=function(t,e){var r,n,i={};1===arguments.length&&(e=t,t=e.constructor.__base__),n=function(r){return function(){return t[r].apply(e,arguments)}};for(r in t)t.hasOwnProperty(r)&&"function"==typeof t[r]&&(i[r]=n(r));return i},Fiber.decorate=function(t){var e,n=t.constructor.__base__,s=i.slice.call(arguments,1),o=s.length;for(e=0;o>e;e++)r(s[e].call(t,n),t)},Fiber.mixin=function(t){var e,n=t.__base__,s=i.slice.call(arguments,1),o=s.length;for(e=0;o>e;e++)r(s[e](n),t.prototype)},Fiber.noConflict=function(){return e.Fiber=s,Fiber},t!==undefined?"function"==typeof t.setExports?t.setExports(Fiber):t.exports&&(t.exports=Fiber):e.Fiber=Fiber})(this),c._.Fiber=t.exports}),r(function(t,e,r){!function(t){function e(){this._events={},this._conf&&r.call(this,this._conf)}function r(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners&&(this._events.maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),this.wildcard&&(this.listenerTree={}))}function n(t){this._events={},this.newListener=!1,r.call(this,t)}function i(t,e,r,n){if(!r)return[];var s,o,a,u,c,l,f,h=[],p=e.length,_=e[n],d=e[n+1];if(n===p&&r._listeners){if("function"==typeof r._listeners)return t&&t.push(r._listeners),[r];for(s=0,o=r._listeners.length;o>s;s++)t&&t.push(r._listeners[s]);return[r]}if("*"===_||"**"===_||r[_]){if("*"===_){for(a in r)"_listeners"!==a&&r.hasOwnProperty(a)&&(h=h.concat(i(t,e,r[a],n+1)));return h}if("**"===_){f=n+1===p||n+2===p&&"*"===d,f&&r._listeners&&(h=h.concat(i(t,e,r,p)));for(a in r)"_listeners"!==a&&r.hasOwnProperty(a)&&("*"===a||"**"===a?(r[a]._listeners&&!f&&(h=h.concat(i(t,e,r[a],p))),h=h.concat(i(t,e,r[a],n))):h=a===d?h.concat(i(t,e,r[a],n+2)):h.concat(i(t,e,r[a],n)));return h}h=h.concat(i(t,e,r[_],n+1))}if(u=r["*"],u&&i(t,e,u,n+1),c=r["**"])if(p>n){c._listeners&&i(t,e,c,p);for(a in c)"_listeners"!==a&&c.hasOwnProperty(a)&&(a===d?i(t,e,c[a],n+2):a===_?i(t,e,c[a],n+1):(l={},l[a]=c[a],i(t,e,{"**":l},n+1)))}else c._listeners?i(t,e,c,p):c["*"]&&c["*"]._listeners&&i(t,e,c["*"],p);return h}function s(t,e){t="string"==typeof t?t.split(this.delimiter):t.slice();for(var r=0,n=t.length;n>r+1;r++)if("**"===t[r]&&"**"===t[r+1])return;for(var i=this.listenerTree,s=t.shift();s;){if(i[s]||(i[s]={}),i=i[s],0===t.length){if(i._listeners){if("function"==typeof i._listeners)i._listeners=[i._listeners,e];else if(o(i._listeners)&&(i._listeners.push(e),!i._listeners.warned)){var u=a;this._events.maxListeners!==undefined&&(u=this._events.maxListeners),u>0&&i._listeners.length>u&&(i._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",i._listeners.length),console.trace())}}else i._listeners=e;return!0}s=t.shift()}return!0}var o=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=10;n.prototype.delimiter=".",n.prototype.setMaxListeners=function(t){this._events||e.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t},n.prototype.event="",n.prototype.once=function(t,e){return this.many(t,1,e),this},n.prototype.many=function(t,e,r){function n(){0===--e&&i.off(t,n),r.apply(this,arguments)}var i=this;if("function"!=typeof r)throw Error("many only accepts instances of Function");return n._origin=r,this.on(t,n),i},n.prototype.emit=function(){this._events||e.call(this);var t=arguments[0];if("newListener"===t&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var r=arguments.length,n=Array(r-1),s=1;r>s;s++)n[s-1]=arguments[s];for(s=0,r=this._all.length;r>s;s++)this.event=t,this._all[s].apply(this,n)}if("error"===t&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:Error("Uncaught, unspecified 'error' event.");var o;if(this.wildcard){o=[];var a="string"==typeof t?t.split(this.delimiter):t.slice();i.call(this,o,a,this.listenerTree,0)}else o=this._events[t];if("function"==typeof o){if(this.event=t,1===arguments.length)o.call(this);else if(arguments.length>1)switch(arguments.length){case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:for(var r=arguments.length,n=Array(r-1),s=1;r>s;s++)n[s-1]=arguments[s];o.apply(this,n)}return!0}if(o){for(var r=arguments.length,n=Array(r-1),s=1;r>s;s++)n[s-1]=arguments[s];for(var u=o.slice(),s=0,r=u.length;r>s;s++)this.event=t,u[s].apply(this,n);return u.length>0||this._all}return this._all},n.prototype.on=function(t,r){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof r)throw Error("on only accepts instances of Function");if(this._events||e.call(this),this.emit("newListener",t,r),this.wildcard)return s.call(this,t,r),this;if(this._events[t]){if("function"==typeof this._events[t])this._events[t]=[this._events[t],r];else if(o(this._events[t])&&(this._events[t].push(r),!this._events[t].warned)){var n=a;this._events.maxListeners!==undefined&&(n=this._events.maxListeners),n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}}else this._events[t]=r;return this},n.prototype.onAny=function(t){if(this._all||(this._all=[]),"function"!=typeof t)throw Error("onAny only accepts instances of Function");return this._all.push(t),this},n.prototype.addListener=n.prototype.on,n.prototype.off=function(t,e){if("function"!=typeof e)throw Error("removeListener only takes instances of Function");var r,n=[];if(this.wildcard){var s="string"==typeof t?t.split(this.delimiter):t.slice();n=i.call(this,null,s,this.listenerTree,0)}else{if(!this._events[t])return this;r=this._events[t],n.push({_listeners:r})}for(var a=0;n.length>a;a++){var u=n[a];if(r=u._listeners,o(r)){for(var c=-1,l=0,f=r.length;f>l;l++)if(r[l]===e||r[l].listener&&r[l].listener===e||r[l]._origin&&r[l]._origin===e){c=l;break}if(0>c)continue;return this.wildcard?u._listeners.splice(c,1):this._events[t].splice(c,1),0===r.length&&(this.wildcard?delete u._listeners:delete this._events[t]),this}(r===e||r.listener&&r.listener===e||r._origin&&r._origin===e)&&(this.wildcard?delete u._listeners:delete this._events[t])}return this},n.prototype.offAny=function(t){var e,r=0,n=0;if(t&&this._all&&this._all.length>0){for(e=this._all,r=0,n=e.length;n>r;r++)if(t===e[r])return e.splice(r,1),this}else this._all=[];return this},n.prototype.removeListener=n.prototype.off,n.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||e.call(this),this;if(this.wildcard)for(var r="string"==typeof t?t.split(this.delimiter):t.slice(),n=i.call(this,null,r,this.listenerTree,0),s=0;n.length>s;s++){var o=n[s];o._listeners=null}else{if(!this._events[t])return this;this._events[t]=null}return this},n.prototype.listeners=function(t){if(this.wildcard){var r=[],n="string"==typeof t?t.split(this.delimiter):t.slice();return i.call(this,r,n,this.listenerTree,0),r}return this._events||e.call(this),this._events[t]||(this._events[t]=[]),o(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},n.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof define&&define.amd?define(function(){return n}):t.EventEmitter2=n}(r!==undefined&&r.title!==undefined&&e!==undefined?e:window),c._.EventEmitter=t.exports.EventEmitter2}),r(function(t,e,r){!function(r){"object"==typeof e?t.exports=r():"function"==typeof define&&define.amd?define(r):"undefined"!=typeof window?window.Promise=r():"undefined"!=typeof global?global.Promise=r():"undefined"!=typeof self&&(self.Promise=r())}(function(){return function t(e,r,n){function i(o,a){if(!r[o]){if(!e[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);throw Error("Cannot find module '"+o+"'")}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;n.length>o;o++)i(n[o]);return i}({1:[function(require,t){"use strict";t.exports=function(t,e,r){function n(t,r,n){var s=e(t,i,n,r===!0&&t._isBound()?t._boundTo:void 0),o=s.promise();return o.isRejected()?o:(s.setHowMany(1),s.setUnwrap(),s.init(),o)}var i=require("./some_promise_array.js")(r);require("./assert.js"),t.any=function(e){return n(e,!1,t.any)},t.prototype.any=function(){return n(this,!0,this.any)}}},{"./assert.js":2,"./some_promise_array.js":35}],2:[function(require,t){"use strict";t.exports=function(){var t=function(){function t(t){this.constructor$(t),this.message=t,this.name="AssertionError"}return t.prototype=Error(),t.prototype.constructor=t,t.prototype.constructor$=Error,t}();return function e(r,n){if(r!==!0){var i=new t(n);throw Error.captureStackTrace&&Error.captureStackTrace(i,e),console&&console.error&&console.error(i.stack+""),i}}}()},{}],3:[function(require,t){"use strict";function e(){this._isTickUsed=!1,this._length=0,this._lateBuffer=new n,this._functionBuffer=new n(75e3);var t=this;this.consumeFunctionBuffer=function(){t._consumeFunctionBuffer()}}require("./assert.js");var r=require("./schedule.js"),n=require("./queue.js"),i=require("./util.js").errorObj,s=require("./util.js").tryCatch1;e.prototype.haveItemsQueued=function(){return this._length>0},e.prototype.invokeLater=function(t,e,r){this._lateBuffer.push(t,e,r),this._queueTick()},e.prototype.invoke=function(t,e,r){var n=this._functionBuffer;n.push(t,e,r),this._length=n.length(),this._queueTick()},e.prototype._consumeFunctionBuffer=function(){for(var t=this._functionBuffer;t.length()>0;){var e=t.shift(),r=t.shift(),n=t.shift();e.call(r,n)}this._reset(),this._consumeLateBuffer()},e.prototype._consumeLateBuffer=function(){for(var t=this._lateBuffer;t.length()>0;){var e=t.shift(),r=t.shift(),n=t.shift(),o=s(e,r,n);if(o===i)throw this._queueTick(),o.e}},e.prototype._queueTick=function(){this._isTickUsed||(r(this.consumeFunctionBuffer),this._isTickUsed=!0)},e.prototype._reset=function(){this._isTickUsed=!1,this._length=0},t.exports=new e},{"./assert.js":2,"./queue.js":28,"./schedule.js":31,"./util.js":39}],4:[function(require,t){"use strict";var e=require("./promise.js")();t.exports=e},{"./promise.js":20}],5:[function(require,t){"use strict";t.exports=function(t){function e(t){var e="string"==typeof this?this:""+this;return t[e]}t.prototype.call=function(t){for(var e=arguments.length,r=Array(e-1),n=1;e>n;++n)r[n-1]=arguments[n];return this._then(function(e){return e[t].apply(e,r)},void 0,void 0,void 0,void 0,this.call)},t.prototype.get=function(t){return this._then(e,void 0,void 0,t,void 0,this.get)}}},{}],6:[function(require,t){"use strict";t.exports=function(t,e){var r=require("./errors.js"),n=require("./async.js");require("./assert.js");var i=r.CancellationError,s={};t.prototype._cancel=function(){if(!this.isCancellable())return this;var t;if((t=this._cancellationParent)!==void 0)return t.cancel(s),undefined;var e=new i;this._attachExtraTrace(e),this._rejectUnchecked(e)},t.prototype.cancel=function(t){return this.isCancellable()?t===s?(this._cancel(),this):(n.invokeLater(this._cancel,this,void 0),this):this},t.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)},t.prototype.uncancellable=function(){var r=new t(e);return r._setTrace(this.uncancellable,this),r._follow(this),r._unsetCancellable(),this._isBound()&&r._setBoundTo(this._boundTo),r},t.prototype.fork=function(t,e,r){var n=this._then(t,e,r,void 0,void 0,this.fork);return n._setCancellable(),n._cancellationParent=void 0,n}}},{"./assert.js":2,"./async.js":3,"./errors.js":10}],7:[function(require,t){"use strict";t.exports=function(){function t(t){var r;if("function"==typeof t)r="[function "+(t.name||"anonymous")+"]";else{r=""+t;var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(r))try{var i=JSON.stringify(t);r=i}catch(s){}0===r.length&&(r="(empty array)")}return"(<"+e(r)+">, no stack trace)"}function e(t){var e=41;return e>t.length?t:t.substr(0,e-3)+"..."}function r(t,e){this.captureStackTrace(t,e)}require("./assert.js");var n=require("./util.js").inherits,i=require("./es5.js").defineProperty,s=RegExp("\\b(?:[\\w.]*Promise(?:Array|Spawn)?\\$_\\w+|tryCatch(?:1|2|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),o=null,a=null,u=!1;n(r,Error),r.prototype.captureStackTrace=function(t,e){c(this,t,e)},r.possiblyUnhandledRejection=function(t){if("object"==typeof console){var e;if("object"==typeof t||"function"==typeof t){var r=t.stack;e="Possibly unhandled "+a(r,t)}else e="Possibly unhandled "+(t+"");"function"==typeof console.error||"object"==typeof console.error?console.error(e):("function"==typeof console.log||"object"==typeof console.error)&&console.log(e)}},u="CapturedTrace$captureStackTrace"!==r.prototype.captureStackTrace.name,r.combine=function(t,e){for(var r=t.length-1,n=e.length-1;n>=0;--n){var i=e[n];if(t[r]!==i)break;t.pop(),r--}t.push("From previous event:");for(var a=t.concat(e),u=[],n=0,c=a.length;c>n;++n)s.test(a[n])||n>0&&!o.test(a[n])&&"From previous event:"!==a[n]||u.push(a[n]);return u},r.isSupported=function(){return"function"==typeof c};var c=function l(){if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){o=/^\s*at\s*/,a=function(e,r){return"string"==typeof e?e:r.name!==void 0&&r.message!==void 0?r.name+". "+r.message:t(r)};var e=Error.captureStackTrace;return function(t,r){e(t,r)}}var r=Error();if(!u&&"string"==typeof r.stack&&"function"==typeof"".startsWith&&r.stack.startsWith("stackDetection@")&&"stackDetection"===l.name){i(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),o=/@/;var n=/[@\n]/;return a=function(e,r){return"string"==typeof e?r.name+". "+r.message+"\n"+e:r.name!==void 0&&r.message!==void 0?r.name+". "+r.message:t(r)},function e(t,e){var r,i=e.name,s=Error().stack,o=s.split(n),a=o.length;for(r=0;a>r&&o[r]!==i;r+=2);o=o.slice(r+2),a=o.length-2;var u="";for(r=0;a>r;r+=2)u+=o[r],u+="@",u+=o[r+1],u+="\n";t.stack=u}}return a=function(e,r){return"string"==typeof e?e:"object"!=typeof r&&"function"!=typeof r||r.name===void 0||r.message===void 0?t(r):r.name+". "+r.message},null}();return r}},{"./assert.js":2,"./es5.js":12,"./util.js":39}],8:[function(require,t){"use strict";t.exports=function(t){function e(t,e,r){this._instances=t,this._callback=e,this._promise=r}function r(t,e){var r={},n=s(t,r,e);if(n===o)return n;var i=a(r);return i.length?(o.e=new TypeError("Catch filter must inherit from Error or be a simple predicate function"),o):n}var n=require("./util.js"),i=require("./errors.js"),s=n.tryCatch1,o=n.errorObj,a=require("./es5.js").keys;return e.prototype.doFilter=function(e){for(var n=this._callback,a=this._promise,u=a._isBound()?a._boundTo:void 0,c=0,l=this._instances.length;l>c;++c){var f=this._instances[c],h=f===Error||null!=f&&f.prototype instanceof Error;if(h&&e instanceof f){var p=s(n,u,e);return p===o?(t.e=p.e,t):p}if("function"==typeof f&&!h){var _=r(f,e);if(_===o){var d=i.canAttach(o.e)?o.e:Error(o.e+"");this._promise._attachExtraTrace(d),e=o.e;break}if(_){var p=s(n,u,e);return p===o?(t.e=p.e,t):p}}}return t.e=e,t},e}},{"./errors.js":10,"./es5.js":12,"./util.js":39}],9:[function(require,t){"use strict";var e=require("./util.js");require("./assert.js");var r=e.isPrimitive,n=e.wrapsPrimitiveReceiver;t.exports=function(t){var e=function(){return this},i=function(){throw this},s=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:undefined};t.prototype["return"]=t.prototype.thenReturn=function(t){return n&&r(t)?this._then(s(t,2),void 0,void 0,void 0,void 0,this.thenReturn):this._then(e,void 0,void 0,t,void 0,this.thenReturn)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return n&&r(t)?this._then(s(t,1),void 0,void 0,void 0,void 0,this.thenThrow):this._then(i,void 0,void 0,t,void 0,this.thenThrow)}}},{"./assert.js":2,"./util.js":39}],10:[function(require,t){"use strict";function e(t){try{f(t,"isAsync",!0)}catch(e){}}function r(t){return null==t?!1:t instanceof o||t.isAsync===!0}function n(t){return t instanceof h}function i(t){return n(t)}function s(t,e){function r(n){return this instanceof r?(this.message="string"==typeof n?n:e,this.name=t,h.captureStackTrace&&h.captureStackTrace(this,this.constructor),undefined):new r(n)}return l(r,h),r}function o(t){this.name="RejectionError",this.message=t,this.cause=t,this.isAsync=!0,t instanceof h?(this.message=t.message,this.stack=t.stack):h.captureStackTrace&&h.captureStackTrace(this,this.constructor)}var a=require("./global.js"),u=require("./es5.js").freeze,c=require("./util.js"),l=c.inherits,f=c.notEnumerableProp,h=a.Error,p=a.TypeError;"function"!=typeof p&&(p=s("TypeError","type error"));var _=a.RangeError;"function"!=typeof _&&(_=s("RangeError","range error"));var d=s("CancellationError","cancellation error"),v=s("TimeoutError","timeout error");l(o,h);var y="__BluebirdErrorTypes__",m=a[y];m||(m=u({CancellationError:d,TimeoutError:v,RejectionError:o}),f(a,y,m)),t.exports={Error:h,TypeError:p,RangeError:_,CancellationError:m.CancellationError,RejectionError:m.RejectionError,TimeoutError:m.TimeoutError,originatesFromRejection:r,markAsOriginatingFromRejection:e,canAttach:i}},{"./es5.js":12,"./global.js":16,"./util.js":39}],11:[function(require,t){"use strict";t.exports=function(t){function e(e){var n=new r(e),i=t.rejected(n),s=i._peekContext();return null!=s&&s._attachExtraTrace(n),i}var r=require("./errors.js").TypeError;return e}},{"./errors.js":10}],12:[function(require,t){function e(t){var e=[];for(var r in t)a.call(t,r)&&e.push(r);return e}function r(t,e,r){return t[e]=r.value,t}function n(t){return t}function i(t){try{return Object(t).constructor.prototype}catch(e){return c}}function s(t){try{return"[object Array]"===u.call(t)}catch(e){return!1}}var o=function(){"use strict";return this===void 0}();if(o)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:o};else{var a={}.hasOwnProperty,u={}.toString,c={}.constructor.prototype;t.exports={isArray:s,keys:e,defineProperty:r,freeze:n,getPrototypeOf:i,isES5:o}}},{}],13:[function(require,t){"use strict";t.exports=function(t){function e(t){for(var e=this._settledValue,r=e.length,n=Array(r),i=0,s=0;r>s;++s)t[s]&&(n[i++]=e[s]);return n.length=i,n}require("./assert.js"),require("./util.js").isArray;var r={ref:null};t.filter=function(n,i){return t.map(n,i,r)._then(e,void 0,void 0,r.ref,void 0,t.filter)},t.prototype.filter=function(t){return this.map(t,r)._then(e,void 0,void 0,r.ref,void 0,this.filter)}}},{"./assert.js":2,"./util.js":39}],14:[function(require,t){t.exports=function(t,e){function r(){return this}function n(){throw this}function i(t){return function(){return t}}function s(t){return function(){throw t}}function o(t,e,a){var u=c&&l(e);return a?t._then(u?r:i(e),f,void 0,e,void 0,o):t._then(u?n:s(e),f,void 0,e,void 0,o)}function a(r){var n=this.promise,i=this.handler,s=n._isBound()?i.call(n._boundTo):i();if(s!==void 0){var u=t._cast(s,a,void 0);if(t.is(u))return o(u,r,n.isFulfilled())}return n.isRejected()?(e.e=r,e):r}var u=require("./util.js"),c=u.wrapsPrimitiveReceiver,l=u.isPrimitive,f=u.thrower;t.prototype.lastly=t.prototype["finally"]=function(t){if("function"!=typeof t)return this.then();var e={promise:this,handler:t};return this._then(a,a,void 0,e,void 0,this.lastly)}}},{"./util.js":39}],15:[function(require,t){"use strict";t.exports=function(t,e,r){var n=require("./promise_spawn.js")(t,r),i=require("./errors.js"),s=i.TypeError;t.coroutine=function(t){if("function"!=typeof t)throw new s("generatorFunction must be a function");var e=n;return function r(){var n=t.apply(this,arguments),i=new e(void 0,void 0,r);return i._generator=n,i._next(void 0),i.promise()}},t.spawn=function(r){if("function"!=typeof r)return e("generatorFunction must be a function");var i=new n(r,this,t.spawn),s=i.promise();return i._run(t.spawn),s}}},{"./errors.js":10,"./promise_spawn.js":24}],16:[function(require,t){"use strict";t.exports=function(){return this!==undefined?this:r!==undefined&&"undefined"!=typeof global&&"string"==typeof r.execPath?global:"undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator&&null!==navigator&&"string"==typeof navigator.appName?window.wrappedJSObject!==undefined?window.wrappedJSObject:window:undefined}()},{}],17:[function(require,t){"use strict";t.exports=function(t,e,r,n){function i(n){var s=this,o=void 0;"function"!=typeof s&&(o=s.receiver,s=s.fn);var a=!1,u=Array(n.length);if(o===void 0)for(var c=0,l=n.length;l>c;++c){var f=s(n[c],c,l);if(!a){var h=t._cast(f,i,void 0);if(h instanceof t){if(h.isFulfilled()){u[c]=h._settledValue;continue}a=!0,f=h}}u[c]=f}else for(var c=0,l=n.length;l>c;++c){var f=s.call(o,n[c],c,l);if(!a){var h=t._cast(f,i,void 0);if(h instanceof t){if(h.isFulfilled()){u[c]=h._settledValue;continue}a=!0,f=h}}u[c]=f}return a?e(u,r,i,void 0).promise():u}function s(t,s,o,a,u){if("function"!=typeof s)return n("fn must be a function");o===!0&&t._isBound()&&(s={fn:s,receiver:t._boundTo});var c=e(t,r,a,o===!0&&t._isBound()?t._boundTo:void 0).promise();return u!==void 0&&(u.ref=c),c._then(i,void 0,void 0,s,void 0,a)}require("./assert.js"),t.prototype.map=function(t,e){return s(this,t,!0,this.map,e)},t.map=function(e,r,n){return s(e,r,!1,t.map,n)}}},{"./assert.js":2}],18:[function(require,t){"use strict";t.exports=function(t){function e(t){throw t}function r(t,r){var n=this,i=o(n,r,null,t);i===u&&s.invokeLater(e,void 0,i.e)}function n(t,r){var n=this,i=a(n,r,t);i===u&&s.invokeLater(e,void 0,i.e)}var i=require("./util.js"),s=require("./async.js");require("./assert.js");var o=i.tryCatch2,a=i.tryCatch1,u=i.errorObj;t.prototype.nodeify=function(t){return"function"==typeof t&&this._then(r,n,void 0,t,this._isBound()?this._boundTo:null,this.nodeify),this}}},{"./assert.js":2,"./async.js":3,"./util.js":39}],19:[function(require,t){"use strict";t.exports=function(t,e){require("./assert.js");var r=require("./util.js"),n=require("./async.js"),i=require("./errors.js"),s=r.tryCatch1,o=r.errorObj;t.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0,this.progressed)},t.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(t)},t.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[t+2-5]},t.prototype._doProgressWith=function(e){var r=e.value,n=e.handler,a=e.promise,u=e.receiver;this._pushContext();var c=s(n,u,r);if(this._popContext(),c===o){if(null!=c.e&&"StopProgressPropagation"!==c.e.name){var l=i.canAttach(c.e)?c.e:Error(c.e+"");a._attachExtraTrace(l),a._progress(c.e)}}else t.is(c)?c._then(a._progress,null,null,a,void 0,this._progress):a._progress(c)},t.prototype._progressUnchecked=function(r){if(this.isPending())for(var i=this._length(),s=0;i>s;s+=5){var o=this._progressHandlerAt(s),a=this._promiseAt(s);if(t.is(a))"function"==typeof o?n.invoke(this._doProgressWith,this,{handler:o,promise:a,receiver:this._receiverAt(s),value:r}):n.invoke(a._progress,a,r);else{var u=this._receiverAt(s);"function"==typeof o?o.call(u,r,a):t.is(u)&&u._isProxied()?u._progressUnchecked(r):e(u,a)&&u._promiseProgressed(r,a)}}}}},{"./assert.js":2,"./async.js":3,"./errors.js":10,"./util.js":39}],20:[function(require,t){"use strict";t.exports=function(){function t(t){return t===void 0?!1:t instanceof n}function e(t,e){return t instanceof p?e>=0:!1}function n(t){if("function"!=typeof t)throw new E("the promise constructor requires a resolver function");if(this.constructor!==n)throw new E("the promise constructor cannot be invoked directly");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,this._boundTo=void 0,t!==l&&this._resolveFromResolver(t)}function i(t,e,r){return s(t,p,r,e===!0&&t._isBound()?t._boundTo:void 0).promise()}function s(e,r,i,o){var a=null;return y(e)?a=e:(a=n._cast(e,i,void 0),a!==e?a._setBoundTo(o):t(a)||(a=null)),null!==a?new r(a,"function"==typeof i?i:s,o):{promise:function(){return C("expecting an array, a promise or a thenable")}}}var o=require("./global.js");require("./assert.js");var a=require("./util.js"),u=require("./async.js"),c=require("./errors.js"),l=function(){},f={},h={e:null},p=require("./promise_array.js")(n,l),_=require("./captured_trace.js")(),d=require("./catch_filter.js")(h),v=require("./promise_resolver.js"),y=a.isArray,m=a.errorObj,g=a.tryCatch1,j=a.tryCatch2,b=a.tryCatchApply,w=c.RangeError,E=c.TypeError,k=c.CancellationError,x=c.TimeoutError,T=c.RejectionError,A=c.originatesFromRejection,P=c.markAsOriginatingFromRejection,F=c.canAttach,R=a.thrower,C=require("./errors_api_rejection")(n),O=function(){return new E("circular promise resolution chain")};n.prototype.bind=function(t){var e=new n(l);return S&&e._setTrace(this.bind,this),e._follow(this),e._setBoundTo(t),this._cancellable()&&(e._setCancellable(),e._cancellationParent=this),e},n.prototype.toString=function(){return"[object Promise]"},n.prototype.caught=n.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var r,n=Array(e-1),i=0;for(r=0;e-1>r;++r){var s=arguments[r];if("function"!=typeof s){var o=new E("A catch filter must be an error constructor or a filter function");return this._attachExtraTrace(o),u.invoke(this._reject,this,o),undefined}n[i++]=s}n.length=i,t=arguments[r],this._resetTrace(this.caught);var a=new d(n,t,this);return this._then(void 0,a.doFilter,void 0,a,void 0,this.caught)}return this._then(void 0,t,void 0,void 0,void 0,this.caught)},n.prototype.then=function(t,e,r){return this._then(t,e,r,void 0,void 0,this.then)},n.prototype.done=function(t,e,r){var n=this._then(t,e,r,void 0,void 0,this.done);n._setIsFinal()},n.prototype.spread=function(t,e){return this._then(t,e,void 0,f,void 0,this.spread)},n.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},n.prototype.isRejected=function(){return(134217728&this._bitField)>0},n.prototype.isPending=function(){return!this.isResolved()},n.prototype.isResolved=function(){return(402653184&this._bitField)>0},n.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},n.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this._settledValue,t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this._settledValue,t.isRejected=!0),t},n.prototype.all=function(){return i(this,!0,this.all)},n.is=t,n.all=function(t){return i(t,!1,n.all)},n.join=function(){for(var t=arguments.length,e=Array(t),r=0;t>r;++r)e[r]=arguments[r];return s(e,p,n.join,void 0).promise()},n.resolve=n.fulfilled=function(t,e){var r=new n(l);return S&&r._setTrace("function"==typeof e?e:n.resolve,void 0),r._tryFollow(t)?r:(r._cleanValues(),r._setFulfilled(),r._settledValue=t,r)},n.reject=n.rejected=function(t){var e=new n(l);if(S&&e._setTrace(n.reject,void 0),P(t),e._cleanValues(),e._setRejected(),e._settledValue=t,!F(t)){var r=Error(t+"");e._setCarriedStackTrace(r)}return e._ensurePossibleRejectionHandled(),e},n.prototype.error=function(t){return this.caught(A,t)},n.prototype._resolveFromSyncValue=function(t,e){if(t===m)this._cleanValues(),this._setRejected(),this._settledValue=t.e,this._ensurePossibleRejectionHandled();else{var r=n._cast(t,e,void 0);r instanceof n?this._follow(r):(this._cleanValues(),this._setFulfilled(),this._settledValue=t)}},n.method=function(t){if("function"!=typeof t)throw new E("fn must be a function");return function e(){var r;switch(arguments.length){case 0:r=g(t,this,void 0);break;case 1:r=g(t,this,arguments[0]);break;case 2:r=j(t,this,arguments[0],arguments[1]);break;default:for(var i=arguments.length,s=Array(i),o=0;i>o;++o)s[o]=arguments[o];r=b(t,s,this)}var a=new n(l);return S&&a._setTrace(e,void 0),a._resolveFromSyncValue(r,e),a}},n.attempt=n["try"]=function(t,e,r){if("function"!=typeof t)return C("fn must be a function");var i=y(e)?b(t,e,r):g(t,r,e),s=new n(l);return S&&s._setTrace(n.attempt,void 0),s._resolveFromSyncValue(i,n.attempt),s},n.defer=n.pending=function(t){var e=new n(l);return S&&e._setTrace("function"==typeof t?t:n.defer,void 0),new v(e)},n.bind=function(t){var e=new n(l);return S&&e._setTrace(n.bind,void 0),e._setFulfilled(),e._setBoundTo(t),e},n.cast=function(t,e){"function"!=typeof e&&(e=n.cast);var r=n._cast(t,e,void 0);return r instanceof n?r:n.resolve(r,e)},n.onPossiblyUnhandledRejection=function(t){_.possiblyUnhandledRejection="function"==typeof t?t:void 0};var S=!1||!(r===undefined||"string"!=typeof r.execPath||"object"!=typeof r.env||!r.env.BLUEBIRD_DEBUG&&"development"!==r.env.NODE_ENV);n.longStackTraces=function(){if(u.haveItemsQueued()&&S===!1)throw Error("cannot enable long stack traces after promises have been created");S=_.isSupported()},n.hasLongStackTraces=function(){return S&&_.isSupported()},n.prototype._setProxyHandlers=function(t,e){var r=this._length();if(r>=1048570&&(r=0,this._setLength(0)),0===r)this._promise0=e,this._receiver0=t;else{var n=r-5;this[n+3]=e,this[n+4]=t,this[n+0]=this[n+1]=this[n+2]=void 0}this._setLength(r+5)},n.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},n.prototype._proxyPromise=function(t){t._setProxied(),this._setProxyHandlers(t,-1)},n.prototype._then=function(t,e,r,i,s,o){var a=s!==void 0,c=a?s:new n(l);if(S&&!a){var f=this._peekContext()===this._traceParent;c._traceParent=f?this._traceParent:this,c._setTrace("function"==typeof o?o:this._then,this)}!a&&this._isBound()&&c._setBoundTo(this._boundTo);
var h=this._addCallbacks(t,e,r,c,i);return!a&&this._cancellable()&&(c._setCancellable(),c._cancellationParent=this),this.isResolved()&&u.invoke(this._queueSettleAt,this,h),c},n.prototype._length=function(){return 1048575&this._bitField},n.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},n.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},n.prototype._setLength=function(t){this._bitField=-1048576&this._bitField|1048575&t},n.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},n.prototype._setRejected=function(){this._bitField=134217728|this._bitField},n.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},n.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},n.prototype._isFinal=function(){return(33554432&this._bitField)>0},n.prototype._cancellable=function(){return(67108864&this._bitField)>0},n.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},n.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},n.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField},n.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},n.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},n.prototype._unsetCarriedStackTrace=function(){this._bitField=-1048577&this._bitField,this._fulfillmentHandler0=void 0},n.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},n.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},n.prototype._receiverAt=function(t){var e;return e=0===t?this._receiver0:this[t+4-5],this._isBound()&&e===void 0?this._boundTo:e},n.prototype._promiseAt=function(t){return 0===t?this._promise0:this[t+3-5]},n.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[t+0-5]},n.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[t+1-5]},n.prototype._unsetAt=function(t){0===t?(this._rejectionHandler0=this._progressHandler0=this._promise0=this._receiver0=void 0,this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0)):this[t-5+0]=this[t-5+1]=this[t-5+2]=this[t-5+3]=this[t-5+4]=void 0},n.prototype._resolveFromResolver=function(t){function e(t){n._tryFollow(t)||n._fulfill(t)}function r(t){var e=F(t)?t:Error(t+"");n._attachExtraTrace(e),P(t),n._reject(t,e===t?void 0:e)}var n=this,i=S;i&&(this._setTrace(this._resolveFromResolver,void 0),this._pushContext());var s=j(t,void 0,e,r);if(i&&this._popContext(),s!==void 0&&s===m){var o=F(s.e)?s.e:Error(s.e+"");n._reject(s.e,o)}},n.prototype._addCallbacks=function(t,e,r,n,i){var s=this._length();if(s>=1048570&&(s=0,this._setLength(0)),0===s)this._promise0=n,i!==void 0&&(this._receiver0=i),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=t),"function"==typeof e&&(this._rejectionHandler0=e),"function"==typeof r&&(this._progressHandler0=r);else{var o=s-5;this[o+3]=n,this[o+4]=i,this[o+0]="function"==typeof t?t:void 0,this[o+1]="function"==typeof e?e:void 0,this[o+2]="function"==typeof r?r:void 0}return this._setLength(s+5),s},n.prototype._setBoundTo=function(t){t!==void 0?(this._bitField=8388608|this._bitField,this._boundTo=t):this._bitField=-8388609&this._bitField},n.prototype._isBound=function(){return 8388608===(8388608&this._bitField)},n.prototype._spreadSlowCase=function(t,e,r,n){var i=s(r,p,this._spreadSlowCase,n).promise()._then(function(){return t.apply(n,arguments)},void 0,void 0,f,void 0,this._spreadSlowCase);e._follow(i)},n.prototype._callSpread=function(e,r,i,s){var o=this._isBound()?this._boundTo:void 0;if(y(i))for(var a=this._settlePromiseFromHandler,u=0,c=i.length;c>u;++u)if(t(n._cast(i[u],a,void 0)))return this._spreadSlowCase(e,r,i,o),undefined;return s&&r._pushContext(),b(e,i,o)},n.prototype._callHandler=function(t,e,r,n,i){var s;return e!==f||this.isRejected()?(i&&r._pushContext(),s=g(t,e,n)):s=this._callSpread(t,r,n,i),i&&r._popContext(),s},n.prototype._settlePromiseFromHandler=function(e,r,i,s){if(!t(s))return e.call(r,i,s),undefined;var o=S,a=this._callHandler(e,r,s,i,o);if(!s._isFollowing())if(a===m||a===s||a===h){var u=a===s?O():a.e,c=F(u)?u:Error(u+"");a!==h&&s._attachExtraTrace(c),s._rejectUnchecked(u,c)}else{var l=n._cast(a,o?this._settlePromiseFromHandler:void 0,s);if(t(l)){if(l.isRejected()&&!l._isCarryingStackTrace()&&!F(l._settledValue)){var c=Error(l._settledValue+"");s._attachExtraTrace(c),l._setCarriedStackTrace(c)}s._follow(l),l._cancellable()&&(s._cancellationParent=l,s._setCancellable())}else s._fulfillUnchecked(a)}},n.prototype._follow=function(t){this._setFollowing(),t.isPending()?(t._cancellable()&&(this._cancellationParent=t,this._setCancellable()),t._proxyPromise(this)):t.isFulfilled()?this._fulfillUnchecked(t._settledValue):this._rejectUnchecked(t._settledValue,t._getCarriedStackTrace()),t._isRejectionUnhandled()&&t._unsetRejectionIsUnhandled(),S&&null==t._traceParent&&(t._traceParent=this)},n.prototype._tryFollow=function(e){if(this._isFollowingOrFulfilledOrRejected()||e===this)return!1;var r=n._cast(e,this._tryFollow,void 0);return t(r)?(this._follow(r),!0):!1},n.prototype._resetTrace=function(t){if(S){var e=this._peekContext(),r=e===void 0;this._trace=new _("function"==typeof t?t:this._resetTrace,r)}},n.prototype._setTrace=function(t,e){if(S){var r=this._peekContext();this._traceParent=r;var n=r===void 0;this._trace=e!==void 0&&e._traceParent===r?e._trace:new _("function"==typeof t?t:this._setTrace,n)}return this},n.prototype._attachExtraTrace=function(t){if(S){var e=this,r=t.stack;r="string"==typeof r?r.split("\n"):[];for(var n=1;null!=e&&null!=e._trace;)r=_.combine(r,e._trace.stack.split("\n")),e=e._traceParent;var i=Error.stackTraceLimit+n,s=r.length;s>i&&(r.length=i),t.stack=n>=r.length?"(No stack trace)":r.join("\n")}},n.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},n.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},n.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},n.prototype._settlePromiseAt=function(t){var r=this.isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),i=this._settledValue,s=this._receiverAt(t),o=this._promiseAt(t);if("function"==typeof r)this._settlePromiseFromHandler(r,s,i,o);else{var a=!1,u=this.isFulfilled();s!==void 0&&(s instanceof n&&s._isProxied()?(s._unsetProxied(),u?s._fulfillUnchecked(i):s._rejectUnchecked(i,this._getCarriedStackTrace()),a=!0):e(s,o)&&(u?s._promiseFulfilled(i,o):s._promiseRejected(i,o),a=!0)),a||(u?o._fulfill(i):o._reject(i,this._getCarriedStackTrace()))}t>=256&&this._queueGC()},n.prototype._isProxied=function(){return 4194304===(4194304&this._bitField)},n.prototype._setProxied=function(){this._bitField=4194304|this._bitField},n.prototype._unsetProxied=function(){this._bitField=-4194305&this._bitField},n.prototype._isGcQueued=function(){return-1073741824===(-1073741824&this._bitField)},n.prototype._setGcQueued=function(){this._bitField=-1073741824|this._bitField},n.prototype._unsetGcQueued=function(){this._bitField=1073741823&this._bitField},n.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),u.invokeLater(this._gc,this,void 0))},n.prototype._gc=function(){var t=this._length();this._unsetAt(0);for(var e=0;t>e;e++)delete this[e];this._setLength(0),this._unsetGcQueued()},n.prototype._queueSettleAt=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),u.invoke(this._settlePromiseAt,this,t)},n.prototype._fulfillUnchecked=function(t){if(this.isPending()){if(t===this){var e=O();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._cleanValues(),this._setFulfilled(),this._settledValue=t;var r=this._length();r>0&&u.invoke(this._fulfillPromises,this,r)}},n.prototype._rejectUncheckedCheckError=function(t){var e=F(t)?t:Error(t+"");this._rejectUnchecked(t,e===t?void 0:e)},n.prototype._rejectUnchecked=function(t,e){if(this.isPending()){if(t===this){var r=O();return this._attachExtraTrace(r),this._rejectUnchecked(r)}if(this._cleanValues(),this._setRejected(),this._settledValue=t,this._isFinal())return u.invokeLater(R,void 0,e===void 0?t:e),undefined;var n=this._length();e!==void 0&&this._setCarriedStackTrace(e),n>0?u.invoke(this._rejectPromises,this,n):this._ensurePossibleRejectionHandled()}},n.prototype._rejectPromises=function(t){t=this._length();for(var e=0;t>e;e+=5)this._settlePromiseAt(e);this._unsetCarriedStackTrace()},n.prototype._fulfillPromises=function(t){t=this._length();for(var e=0;t>e;e+=5)this._settlePromiseAt(e)},n.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled(),_.possiblyUnhandledRejection!==void 0&&u.invokeLater(this._notifyUnhandledRejection,this,void 0)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue,e=this._getCarriedStackTrace();this._unsetRejectionIsUnhandled(),e!==void 0&&(this._unsetCarriedStackTrace(),t=e),"function"==typeof _.possiblyUnhandledRejection&&_.possiblyUnhandledRejection(t,this)}};var B=[];n.prototype._peekContext=function(){var t=B.length-1;return t>=0?B[t]:void 0},n.prototype._pushContext=function(){S&&B.push(this)},n.prototype._popContext=function(){S&&B.pop()};var V=o.Promise;return n.noConflict=function(){return o.Promise===n&&(o.Promise=V),n},_.isSupported()||(n.longStackTraces=function(){},S=!1),n._makeSelfResolutionError=O,require("./finally.js")(n,h),require("./direct_resolve.js")(n),require("./thenables.js")(n,l),n.RangeError=w,n.CancellationError=k,n.TimeoutError=x,n.TypeError=E,n.RejectionError=T,require("./timers.js")(n,l),require("./synchronous_inspection.js")(n),require("./any.js")(n,s,p),require("./race.js")(n,l),require("./call_get.js")(n),require("./filter.js")(n,s,p,C),require("./generators.js")(n,C,l),require("./map.js")(n,s,p,C),require("./nodeify.js")(n),require("./promisify.js")(n,l),require("./props.js")(n,p),require("./reduce.js")(n,s,p,C,l),require("./settle.js")(n,s,p),require("./some.js")(n,s,p,C),require("./progress.js")(n,e),require("./cancel.js")(n,l),n.prototype=n.prototype,n}},{"./any.js":1,"./assert.js":2,"./async.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./direct_resolve.js":9,"./errors.js":10,"./errors_api_rejection":11,"./filter.js":13,"./finally.js":14,"./generators.js":15,"./global.js":16,"./map.js":17,"./nodeify.js":18,"./progress.js":19,"./promise_array.js":21,"./promise_resolver.js":23,"./promisify.js":25,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":34,"./synchronous_inspection.js":36,"./thenables.js":37,"./timers.js":38,"./util.js":39}],21:[function(require,t){"use strict";t.exports=function(t,e){function r(t){switch(t){case-1:return void 0;case-2:return[];case-3:return{}}}function n(r,n,i){var s=this._promise=new t(e),o=void 0;t.is(r)&&(o=r,r._cancellable()&&(s._setCancellable(),s._cancellationParent=r),r._isBound()&&s._setBoundTo(i)),s._setTrace(n,o),this._values=r,this._length=0,this._totalResolved=0,this._init(void 0,-2)}require("./assert.js");var i=require("./errors.js").canAttach,s=require("./util.js"),o=require("./async.js"),a={}.hasOwnProperty,u=s.isArray;return n.PropertiesPromiseArray=function(){},n.prototype.length=function(){return this._length},n.prototype.promise=function(){return this._promise},n.prototype._init=function(e,i){var s=this._values;if(t.is(s)){if(!s.isFulfilled())return s.isPending()?(s._then(this._init,this._reject,void 0,this,i,this.constructor),undefined):(this._reject(s._settledValue),undefined);if(s=s._settledValue,!u(s)){var c=new t.TypeError("expecting an array, a promise or a thenable");return this.__hardReject__(c),undefined}this._values=s}if(0===s.length)return this._resolve(r(i)),undefined;var l,f=s.length,h=f;l=this instanceof n.PropertiesPromiseArray?this._values:Array(f);for(var p=!1,_=0;f>_;++_){var d=s[_];if(d!==void 0||a.call(s,_)){var v=t._cast(d,void 0,void 0);v instanceof t&&v.isPending()?v._proxyPromiseArray(this,_):p=!0,l[_]=v}else h--}if(0===h)return-2===i?this._resolve(l):this._resolve(r(i)),undefined;if(this._values=l,this._length=h,p){var y=h===f?this._scanDirectValues:this._scanDirectValuesHoled;o.invoke(y,this,f)}},n.prototype._settlePromiseAt=function(e){var r=this._values[e];t.is(r)?r.isFulfilled()?this._promiseFulfilled(r._settledValue,e):r.isRejected()&&this._promiseRejected(r._settledValue,e):this._promiseFulfilled(r,e)},n.prototype._scanDirectValuesHoled=function(t){for(var e=0;t>e&&!this._isResolved();++e)a.call(this._values,e)&&this._settlePromiseAt(e)},n.prototype._scanDirectValues=function(t){for(var e=0;t>e&&!this._isResolved();++e)this._settlePromiseAt(e)},n.prototype._isResolved=function(){return null===this._values},n.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},n.prototype.__hardReject__=n.prototype._reject=function(t){this._values=null;var e=i(t)?t:Error(t+"");this._promise._attachExtraTrace(e),this._promise._reject(t,e)},n.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({index:e,value:t})},n.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var r=++this._totalResolved;r>=this._length&&this._resolve(this._values)}},n.prototype._promiseRejected=function(t){this._isResolved()||(this._totalResolved++,this._reject(t))},n}},{"./assert.js":2,"./async.js":3,"./errors.js":10,"./util.js":39}],22:[function(require,t){"use strict";function e(t){t!==void 0?(this._bitField=t._bitField,this._settledValue=t.isResolved()?t._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}var r=require("./errors.js").TypeError;e.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=function(){return 0===(402653184&this._bitField)},e.prototype.value=function(){if(!this.isFulfilled())throw new r("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue},e.prototype.error=function(){if(!this.isRejected())throw new r("cannot get rejection reason of a non-rejected promise");return this._settledValue},t.exports=e},{"./errors.js":10}],23:[function(require,t){"use strict";function e(t){return t instanceof Error&&h.getPrototypeOf(t)===Error.prototype}function r(t){var r;return r=e(t)?new c(t):t,a.markAsOriginatingFromRejection(r),r}function n(t){function e(e,n){if(null!==t){if(e){var i=r(o(e));t._attachExtraTrace(i),t._reject(i)}else if(arguments.length>2){for(var s=arguments.length,a=Array(s-1),u=1;s>u;++u)a[u-1]=arguments[u];t._fulfill(a)}else t._fulfill(n);t=null}}return e}var i,s=require("./util.js"),o=s.maybeWrapAsError,a=require("./errors.js"),u=a.TimeoutError,c=a.RejectionError,l=require("./async.js"),f=s.haveGetters,h=require("./es5.js");if(i=f?function i(t){this.promise=t}:function i(t){this.promise=t,this.asCallback=n(t),this.callback=this.asCallback},f){var p={get:function(){return n(this.promise)}};h.defineProperty(i.prototype,"asCallback",p),h.defineProperty(i.prototype,"callback",p)}i._nodebackForPromise=n,i.prototype.toString=function(){return"[object PromiseResolver]"},i.prototype.resolve=i.prototype.fulfill=function(t){var e=this.promise;e._tryFollow(t)||l.invoke(e._fulfill,e,t)},i.prototype.reject=function(t){var e=this.promise;a.markAsOriginatingFromRejection(t);var r=a.canAttach(t)?t:Error(t+"");e._attachExtraTrace(r),l.invoke(e._reject,e,t),r!==t&&l.invoke(this._setCarriedStackTrace,this,r)},i.prototype.progress=function(t){l.invoke(this.promise._progress,this.promise,t)},i.prototype.cancel=function(){l.invoke(this.promise.cancel,this.promise,void 0)},i.prototype.timeout=function(){this.reject(new u("timeout"))},i.prototype.isResolved=function(){return this.promise.isResolved()},i.prototype.toJSON=function(){return this.promise.toJSON()},i.prototype._setCarriedStackTrace=function(t){this.promise.isRejected()&&this.promise._setCarriedStackTrace(t)},t.exports=i},{"./async.js":3,"./errors.js":10,"./es5.js":12,"./util.js":39}],24:[function(require,t){"use strict";t.exports=function(t,e){function r(r,n,i){var s=this._promise=new t(e);s._setTrace(i,void 0),this._generatorFunction=r,this._receiver=n,this._generator=void 0}var n=require("./errors.js"),i=n.TypeError,s=require("./util.js"),o=s.isArray,a=s.errorObj,u=s.tryCatch1;return r.prototype.promise=function(){return this._promise},r.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},r.prototype._continue=function c(e){if(e===a){this._generator=void 0;var r=n.canAttach(e.e)?e.e:Error(e.e+"");return this._promise._attachExtraTrace(r),this._promise._reject(e.e,r),undefined}var s=e.value;if(e.done===!0)this._generator=void 0,this._promise._tryFollow(s)||this._promise._fulfill(s);else{var u=t._cast(s,c,void 0);if(!(u instanceof t)){if(!o(u))return this._throw(new i("A value was yielded that could not be treated as a promise")),undefined;u=t.all(u)}u._then(this._next,this._throw,void 0,this,null,void 0)}},r.prototype._throw=function(t){n.canAttach(t)&&this._promise._attachExtraTrace(t),this._continue(u(this._generator["throw"],this._generator,t))},r.prototype._next=function(t){this._continue(u(this._generator.next,this._generator,t))},r}},{"./errors.js":10,"./util.js":39}],25:[function(require,t){"use strict";t.exports=function(t,e){function r(t){return t.__isPromisified__===!0}function n(t){for(var e=[t],r=Math.max(0,t-1-5),n=t-1;n>=r;--n)n!==t&&e.push(n);for(var n=t+1;5>=n;++n)e.push(n);return e}function i(t){for(var e=Array(t),r=0;e.length>r;++r)e[r]="_arg"+r;return e.join(", ")}function s(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}function o(t){var e=/^[a-z$_][a-z$_0-9]*$/i;return e.test(t)?"."+t:"['"+t.replace(/(['\\])/g,"\\$1")+"']"}function a(r,a,u,c){function l(t){for(var e=Array(t),n=0,i=e.length;i>n;++n)e[n]="arguments["+n+"]";var s=t>0?",":"";return"string"==typeof r&&a===f?"this"+o(r)+"("+e.join(",")+s+" fn);"+"break;":(a===void 0?"callback("+e.join(",")+s+" fn);":"callback.call("+(a===f?"this":"receiver")+", "+e.join(",")+s+" fn);")+"break;"}function h(){for(var t="",e=0;y.length>e;++e)t+="case "+y[e]+":"+l(y[e]);return t+="default: var args = new Array(len + 1);var i = 0;for (var i = 0; i < len; ++i) {    args[i] = arguments[i];}args[i] = fn;"+("string"==typeof r?"this"+o(r)+".apply(":"callback.apply(")+(a===f?"this":"receiver")+", args); break;"}var p=Math.max(0,s(c)-1),y=n(p),m="string"==typeof u?u+"Async":"promisified";return Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","var ret = function "+m+"("+i(p)+') {"use strict";'+"var len = arguments.length;"+"var promise = new Promise(INTERNAL);"+"promise._setTrace("+m+", void 0);"+"var fn = nodebackForPromise(promise);"+"try {"+"switch(len) {"+h()+"}"+"}"+"catch(e){ "+"var wrapped = maybeWrapAsError(e);"+"promise._attachExtraTrace(wrapped);"+"promise._reject(wrapped);"+"}"+"return promise;"+"}; ret.__isPromisified__ = true; return ret;")(t,r,a,d,v,_,e)}function u(r,n){function i(){var s=n;n===f&&(s=this),"string"==typeof r&&(r=s[r]);var o=new t(e);o._setTrace(i,void 0);var a=_(o);try{r.apply(s,d(arguments,a))}catch(u){var c=v(u);o._attachExtraTrace(c),o._reject(c)}return o}return i.__isPromisified__=!0,i}function c(){}function l(t,e,r){if(r){for(var n=w(t),i=0,s=n.length;s>i;i+=2){var o=n[i],a=n[i+1],u=o+"__beforePromisified__",l=o+"Async";m(t,u,a),t[l]=E(u,f,o,a)}return n.length>16&&(c.prototype=t),t}return E(t,e,void 0,t)}var f={},h=require("./util.js"),p=require("./es5.js"),_=require("./promise_resolver.js")._nodebackForPromise,d=h.withAppended,v=h.maybeWrapAsError,y=h.canEvaluate,m=h.notEnumerableProp,g=h.deprecated;require("./assert.js");var j=RegExp("__beforePromisified__$"),b={}.hasOwnProperty,w=function(){if(p.isES5){var t=Object.create,e=Object.getOwnPropertyDescriptor;return function(n){for(var i=n,s=[],o=t(null);null!==n;){for(var a=p.keys(n),u=0,c=a.length;c>u;++u){var l=a[u];if(!(o[l]||j.test(l)||b.call(i,l+"__beforePromisified__"))){o[l]=!0;var f=e(n,l);null==f||"function"!=typeof f.value||r(f.value)||s.push(l,f.value)}}n=p.getPrototypeOf(n)}return s}}return function(t){var e=[];for(var n in t)if(!j.test(n)&&!b.call(t,n+"__beforePromisified__")){var i=t[n];"function"!=typeof i||r(i)||e.push(n,i)}return e}}(),E=y?a:u;t.promisify=function(t,e){if("object"==typeof t&&null!==t)return g("Promise.promisify for promisifying entire objects is deprecated. Use Promise.promisifyAll instead."),l(t,e,!0);if("function"!=typeof t)throw new TypeError("fn must be a function");return r(t)?t:l(t,2>arguments.length?f:e,!1)},t.promisifyAll=function(t){if("function"!=typeof t&&"object"!=typeof t)throw new TypeError("the target of promisifyAll must be an object or a function");return l(t,void 0,!0)}}},{"./assert.js":2,"./es5.js":12,"./promise_resolver.js":23,"./util.js":39}],26:[function(require,t){"use strict";t.exports=function(t,e){function r(t,e,r){for(var n=s.keys(t),i=Array(n.length),o=0,a=i.length;a>o;++o)i[o]=t[n[o]];if(this.constructor$(i,e,r),!this._isResolved())for(var o=0,a=n.length;a>o;++o)i.push(n[o])}require("./assert.js");var n=require("./util.js"),i=n.inherits,s=require("./es5.js");return i(r,e),r.prototype._init=function(){this._init$(void 0,-3)},r.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var r=++this._totalResolved;if(r>=this._length){for(var n={},i=this.length(),s=0,o=this.length();o>s;++s)n[this._values[s+i]]=this._values[s];this._resolve(n)}}},r.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({key:this._values[e+this.length()],value:t})},e.PropertiesPromiseArray=r,r}},{"./assert.js":2,"./es5.js":12,"./util.js":39}],27:[function(require,t){"use strict";t.exports=function(t,e){function r(e,r,i){var a,u=t._cast(e,i,void 0);return o(u)?(t.is(u)?a=u._then(t.props,void 0,void 0,void 0,void 0,i):(a=new n(u,i,r===!0&&u._isBound()?u._boundTo:void 0).promise(),r=!1),r===!0&&u._isBound()&&a._setBoundTo(u._boundTo),a):s("cannot await properties of a non-object")}var n=require("./properties_promise_array.js")(t,e),i=require("./util.js"),s=require("./errors_api_rejection")(t),o=i.isObject;t.prototype.props=function(){return r(this,!0,this.props)},t.props=function(e){return r(e,!1,t.props)}}},{"./errors_api_rejection":11,"./properties_promise_array.js":26,"./util.js":39}],28:[function(require,t){"use strict";function e(t,e,r,n,i){for(var s=0;i>s;++s)r[s+n]=t[s+e]}function r(t){return t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1}function n(t){return"number"!=typeof t?16:r(Math.min(Math.max(16,t),1073741824))}function i(t){this._capacity=n(t),this._length=0,this._front=0,this._makeCapacity()}require("./assert.js"),i.prototype._willBeOverCapacity=function(t){return t>this._capacity},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var r=this._front+e&this._capacity-1;this[r]=t,this._length=e+1},i.prototype.push=function(t,e,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(t),this._pushOne(e),this._pushOne(r),undefined;var i=this._front+n-3;this._checkCapacity(n);var s=this._capacity-1;this[i+0&s]=t,this[i+1&s]=e,this[i+2&s]=r,this._length=n},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._makeCapacity=function(){for(var t=this._capacity,e=0;t>e;++e)this[e]=void 0},i.prototype._checkCapacity=function(t){t>this._capacity&&this._resizeTo(this._capacity<<3)},i.prototype._resizeTo=function(t){var r=this._front,n=this._capacity,i=Array(n),s=this.length();if(e(this,0,i,0,n),this._capacity=t,this._makeCapacity(),this._front=0,n>=r+s)e(i,r,this,0,s);else{var o=s-(r+s&n-1);e(i,r,this,0,o),e(i,0,this,o,s-o)}},t.exports=i},{"./assert.js":2}],29:[function(require,t){"use strict";t.exports=function(t,e){function r(r,a,u){var c=t._cast(r,a,void 0);if(t.is(c))return s(c);if(!i(r))return n("expecting an array, a promise or a thenable");var l=new t(e);l._setTrace(a,u),u!==void 0&&(u._isBound()&&l._setBoundTo(u._boundTo),u._cancellable()&&(l._setCancellable(),l._cancellationParent=u));for(var f=l._fulfill,h=l._reject,p=0,_=r.length;_>p;++p){var d=r[p];(d!==void 0||o.call(r,p))&&t.cast(d)._then(f,h,void 0,l,null,a)}return l}var n=require("./errors_api_rejection.js")(t),i=require("./util.js").isArray,s=function(t){return t.then(function e(n){return r(n,e,t)})},o={}.hasOwnProperty;t.race=function(e){return r(e,t.race,void 0)},t.prototype.race=function(){return r(this,this.race,void 0)}}},{"./errors_api_rejection.js":11,"./util.js":39}],30:[function(require,t){"use strict";t.exports=function(t,e,r,n,i){function s(e,r,n,s,o){this.promise=new t(i),this.index=r,this.length=s.length,this.items=s,this.callback=e,this.receiver=o,this.accum=n}function o(t,e){var r=this,n=void 0;"function"!=typeof r&&(n=r.receiver,r=r.fn);var i=t.length,o=void 0,a=0;e!==void 0?(o=e,a=0):(a=1,i>0&&(o=t[0]));var u=a;if(u>=i)return o;var c=new s(r,u,o,t,n);return c.iterate(),c.promise}function a(t){var e=this.fn,r=this.initialValue;return o.call(e,t,r)}function u(t,e,r,n,i){return r._then(function s(r){return c(t,e,r,n,s)},void 0,void 0,void 0,void 0,i)}function c(i,s,c,l,f){if("function"!=typeof s)return n("fn must be a function");if(l===!0&&i._isBound()&&(s={fn:s,receiver:i._boundTo}),c!==void 0){if(t.is(c)){if(!c.isFulfilled())return u(i,s,c,l,f);c=c._settledValue}return e(i,r,f,l===!0&&i._isBound()?i._boundTo:void 0).promise()._then(a,void 0,void 0,{fn:s,initialValue:c},void 0,t.reduce)}return e(i,r,f,l===!0&&i._isBound()?i._boundTo:void 0).promise()._then(o,void 0,void 0,s,void 0,f)}require("./assert.js"),s.prototype.reject=function(t){this.promise._reject(t)},s.prototype.fulfill=function(t,e){this.accum=t,this.index=e+1,this.iterate()},s.prototype.iterate=function(){for(var e=this.index,r=this.length,n=this.items,i=this.accum,s=this.receiver,o=this.callback,a=this.iterate;r>e;++e)if(i=t._cast(o.call(s,i,n[e],e,r),a,void 0),i instanceof t)return i._then(this.fulfill,this.reject,void 0,this,e,a),undefined;this.promise._fulfill(i)},t.reduce=function(e,r,n){return c(e,r,n,!1,t.reduce)},t.prototype.reduce=function(t,e){return c(this,t,e,!0,this.reduce)}}},{"./assert.js":2}],31:[function(require,t){"use strict";var e=require("./global.js");require("./assert.js");var n;if(r!==undefined&&null!==r&&"function"==typeof r.cwd&&"function"==typeof r.nextTick)n=0===r.version.indexOf("v0.10.")?function(){function t(){var t=i,e=n;n=null,i=null,null!=e?e.run(t):t()}var e=require("domain"),n=null,i=null;return function(s){n=e.active,i=s,r.nextTick(t)}}():r.nextTick;else if("function"!=typeof e.MutationObserver&&"function"!=typeof e.WebkitMutationObserver&&"function"!=typeof e.WebKitMutationObserver||"undefined"==typeof document||"function"!=typeof document.createElement)if("function"==typeof e.postMessage&&"function"!=typeof e.importScripts&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener){var i="bluebird_message_key_"+Math.random();n=function(){function t(t){if(t.source===e&&t.data===i){var n=r;r=void 0,n()}}var r=void 0;return e.addEventListener("message",t,!1),function t(t){r=t,e.postMessage(i,"*")}}()}else n="function"==typeof e.MessageChannel?function(){var t=void 0,r=new e.MessageChannel;return r.port1.onmessage=function(){var e=t;t=void 0,e()},function(e){t=e,r.port2.postMessage(null)}}():e.setTimeout?function(t){setTimeout(t,4)}:function(t){t()};else n=function(){var t=e.MutationObserver||e.WebkitMutationObserver||e.WebKitMutationObserver,r=document.createElement("div"),n=void 0,i=new t(function(){var t=n;n=void 0,t()});return i.observe(r,{attributes:!0}),function(t){n=t,r.setAttribute("class","foo")}}();t.exports=n},{"./assert.js":2,"./global.js":16,domain:40}],32:[function(require,t){"use strict";t.exports=function(t,e,r){function n(t,r,n){return e(t,i,n,r===!0&&t._isBound()?t._boundTo:void 0).promise()}var i=require("./settled_promise_array.js")(t,r);t.settle=function(e){return n(e,!1,t.settle)},t.prototype.settle=function(){return n(this,!0,this.settle)}}},{"./settled_promise_array.js":33}],33:[function(require,t){"use strict";t.exports=function(t,e){function r(t,e,r){this.constructor$(t,e,r)}require("./assert.js");var n=require("./promise_inspection.js"),i=require("./util.js"),s=i.inherits;return s(r,e),r.prototype._promiseResolved=function(t,e){this._values[t]=e;var r=++this._totalResolved;r>=this._length&&this._resolve(this._values)},r.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){var r=new n;r._bitField=268435456,r._settledValue=t,this._promiseResolved(e,r)}},r.prototype._promiseRejected=function(t,e){if(!this._isResolved()){var r=new n;r._bitField=134217728,r._settledValue=t,this._promiseResolved(e,r)}},r}},{"./assert.js":2,"./promise_inspection.js":22,"./util.js":39}],34:[function(require,t){"use strict";t.exports=function(t,e,r,n){function i(t,r,i,o){if((0|r)!==r||0>r)return n("expecting a positive integer");var a=e(t,s,o,i===!0&&t._isBound()?t._boundTo:void 0),u=a.promise();return u.isRejected()?u:(a.setHowMany(r),a.init(),u)}var s=require("./some_promise_array.js")(r);require("./assert.js"),t.some=function(e,r){return i(e,r,!1,t.some)},t.prototype.some=function(t){return i(this,t,!0,this.some)}}},{"./assert.js":2,"./some_promise_array.js":35}],35:[function(require,t){"use strict";t.exports=function(t){function e(t,e,r){this.constructor$(t,e,r),this._howMany=0,this._unwrap=!1,this._initialized=!1}var r=require("./util.js"),n=require("./errors.js").RangeError,i=r.inherits,s=r.isArray;return i(e,t),e.prototype._init=function(){if(this._initialized){if(0===this._howMany)return this._resolve([]),undefined;this._init$(void 0,-2);var t=s(this._values);if(this._holes=t?this._values.length-this.length():0,!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()){var e="(Promise.some) input array contains less than "+this._howMany+" promises";this._reject(new n(e))}}},e.prototype.init=function(){this._initialized=!0,this._init()},e.prototype.setUnwrap=function(){this._unwrap=!0},e.prototype.howMany=function(){return this._howMany},e.prototype.setHowMany=function(t){this._isResolved()||(this._howMany=t)},e.prototype._promiseFulfilled=function(t){this._isResolved()||(this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values)))},e.prototype._promiseRejected=function(t){this._isResolved()||(this._addRejected(t),this.howMany()>this._canPossiblyFulfill()&&(this._values.length===this.length()?this._reject([]):this._reject(this._values.slice(this.length()+this._holes))))},e.prototype._fulfilled=function(){return this._totalResolved},e.prototype._rejected=function(){return this._values.length-this.length()-this._holes},e.prototype._addRejected=function(t){this._values.push(t)},e.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},e.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},e}},{"./errors.js":10,"./util.js":39}],36:[function(require,t){"use strict";t.exports=function(t){var e=require("./promise_inspection.js");t.prototype.inspect=function(){return new e(this)}}},{"./promise_inspection.js":22}],37:[function(require,t){"use strict";t.exports=function(t,e){function r(t){try{return t.then}catch(e){return u.e=e,u}}function n(o,l,f){if(c(o)){if(o instanceof t)return o;if(i(o)){var h=new t(e);return h._setTrace(l,void 0),o._then(h._fulfillUnchecked,h._rejectUncheckedCheckError,h._progressUnchecked,h,null,void 0),h._setFollowing(),h
}var p=r(o);if(p===u)return l="function"==typeof l?l:n,f!==void 0&&a(p.e)&&f._attachExtraTrace(p.e),t.reject(p.e,l);if("function"==typeof p)return l="function"==typeof l?l:n,s(o,p,l,f)}return o}function i(t){return l.call(t,"_promise0")}function s(e,r,n,i){function s(r){if(!l){if(l=!0,e===r){var n=t._makeSelfResolutionError();return i!==void 0&&i._attachExtraTrace(n),c.promise._reject(n,void 0),undefined}c.resolve(r)}}function o(t){if(!l){l=!0;var e=a(t)?t:Error(t+"");i!==void 0&&i._attachExtraTrace(e),c.promise._reject(t,e)}}function u(t){if(!l){var e=c.promise;"function"==typeof e._progress&&e._progress(t)}}var c=t.defer(n),l=!1;try{r.call(e,s,o,u)}catch(f){if(!l){l=!0;var h=a(f)?f:Error(f+"");i!==void 0&&i._attachExtraTrace(h),c.promise._reject(f,h)}}return c.promise}require("./assert.js");var o=require("./util.js"),a=require("./errors.js").canAttach,u=o.errorObj,c=o.isObject,l={}.hasOwnProperty;t._cast=n}},{"./assert.js":2,"./errors.js":10,"./util.js":39}],38:[function(require,t){"use strict";var e=require("./global.js"),r=function(t,r){for(var n=arguments.length,i=Array(n-2),s=2;n>s;++s)i[s-2]=arguments[s];e.setTimeout(function(){t.apply(void 0,i)},r)},n={};e.setTimeout(function(t){t===n&&(r=e.setTimeout)},1,n),t.exports=function(t,e){require("./util.js"),require("./assert.js");var n=require("./errors.js");require("./errors_api_rejection")(t);var i=t.TimeoutError,s=function(t,e,r){if(t.isPending()){"string"!=typeof e&&(e="operation timed out after "+r+" ms");var s=new i(e);n.markAsOriginatingFromRejection(s),t._attachExtraTrace(s),t._rejectUnchecked(s)}},o=function(t,e){e._fulfill(t)};t.delay=function(n,i,s){i===void 0&&(i=n,n=void 0),i=+i,"function"!=typeof s&&(s=t.delay);var a=t._cast(n,s,void 0),u=new t(e);return t.is(a)?(a._isBound()&&u._setBoundTo(a._boundTo),a._cancellable()&&(u._setCancellable(),u._cancellationParent=a),u._setTrace(s,a),u._follow(a),u.then(function(e){return t.delay(e,i)})):(u._setTrace(s,void 0),r(o,i,n,u),u)},t.prototype.delay=function(e){return t.delay(this,e,this.delay)},t.prototype.timeout=function(n,i){n=+n;var o=new t(e);return o._setTrace(this.timeout,this),this._isBound()&&o._setBoundTo(this._boundTo),this._cancellable()&&(o._setCancellable(),o._cancellationParent=this),o._follow(this),r(s,n,o,i,n),o}}},{"./assert.js":2,"./errors.js":10,"./errors_api_rejection":11,"./global.js":16,"./util.js":39}],39:[function(require,t){"use strict";function e(t){"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("Bluebird: "+t)}function r(t,e,r){try{return t.call(e,r)}catch(n){return v.e=n,v}}function n(t,e,r,n){try{return t.call(e,r,n)}catch(i){return v.e=i,v}}function i(t,e,r){try{return t.apply(r,e)}catch(n){return v.e=n,v}}function s(t){return"string"==typeof t?t:""+t}function o(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function a(t){return!o(t)}function u(t){return o(t)?Error(s(t)):t}function c(t,e){var r,n=t.length,i=Array(n+1);for(r=0;n>r;++r)i[r]=t[r];return i[r]=e,i}function l(t,e,r){var n={value:r,configurable:!0,enumerable:!1,writable:!0};return p.defineProperty(t,e,n),t}function f(t){throw t}var h=require("./global.js");require("./assert.js");var p=require("./es5.js"),_=function(){try{var t={};return p.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(e){return!1}}(),d=function(){return"undefined"!=typeof window&&null!==window&&window.document!==undefined&&"undefined"!=typeof navigator&&null!==navigator&&"string"==typeof navigator.appName&&window===h?!1:!0}(),v={e:{}},y=function(t,e){function r(){this.constructor=t,this.constructor$=e;for(var r in e.prototype)n.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}var n={}.hasOwnProperty;return r.prototype=e.prototype,t.prototype=new r,t.prototype},m=function(){return"string"!==this}.call("string"),g={thrower:f,isArray:p.isArray,haveGetters:_,notEnumerableProp:l,isPrimitive:o,isObject:a,canEvaluate:d,deprecated:e,errorObj:v,tryCatch1:r,tryCatch2:n,tryCatchApply:i,inherits:y,withAppended:c,asString:s,maybeWrapAsError:u,wrapsPrimitiveReceiver:m};t.exports=g},{"./assert.js":2,"./es5.js":12,"./global.js":16}],40:[function(){},{}]},{},[4])(4)}),c._.Bluebird=t.exports}),r(function(t,e,r){function n(t,e){var r=e?W[ae]:W[ie];return r.test(t)?new o(t,e):null}function i(t,e){var r=n(t,e);return r?r.version:null}function s(t,e){var r=n(t,e);return r?r.version:null}function o(t,e){if(t instanceof o){if(t.loose===e)return t;t=t.version}if(!(this instanceof o))return new o(t,e);D("SemVer",t,e),this.loose=e;var r=t.trim().match(e?W[ae]:W[ie]);if(!r)throw new TypeError("Invalid Version: "+t);this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.prerelease=r[4]?r[4].split(".").map(function(t){return/^[0-9]+$/.test(t)?+t:t}):[],this.build=r[5]?r[5].split("."):[],this.format()}function a(t,e,r){try{return new o(t,r).inc(e).version}catch(n){return null}}function u(t,e){var r=Se.test(t),n=Se.test(e);return r&&n&&(t=+t,e=+e),r&&!n?-1:n&&!r?1:e>t?-1:t>e?1:0}function l(t,e){return u(e,t)}function f(t,e,r){return new o(t,r).compare(e)}function h(t,e){return f(t,e,!0)}function p(t,e,r){return f(e,t,r)}function _(t,r){return t.sort(function(t,n){return e.compare(t,n,r)})}function d(t,r){return t.sort(function(t,n){return e.rcompare(t,n,r)})}function v(t,e,r){return f(t,e,r)>0}function y(t,e,r){return 0>f(t,e,r)}function m(t,e,r){return 0===f(t,e,r)}function g(t,e,r){return 0!==f(t,e,r)}function j(t,e,r){return f(t,e,r)>=0}function b(t,e,r){return 0>=f(t,e,r)}function w(t,e,r,n){var i;switch(e){case"===":i=t===r;break;case"!==":i=t!==r;break;case"":case"=":case"==":i=m(t,r,n);break;case"!=":i=g(t,r,n);break;case">":i=v(t,r,n);break;case">=":i=j(t,r,n);break;case"<":i=y(t,r,n);break;case"<=":i=b(t,r,n);break;default:throw new TypeError("Invalid operator: "+e)}return i}function E(t,e){if(t instanceof E){if(t.loose===e)return t;t=t.value}return this instanceof E?(D("comparator",t,e),this.loose=e,this.parse(t),this.value=this.semver===Be?"":this.operator+this.semver.version,undefined):new E(t,e)}function k(t,e){if(t instanceof k&&t.loose===e)return t;if(!(this instanceof k))return new k(t,e);if(this.loose=e,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}function x(t,e){return new k(t,e).set.map(function(t){return t.map(function(t){return t.value}).join(" ").trim().split(" ")})}function T(t,e){return D("comp",t),t=R(t,e),D("caret",t),t=P(t,e),D("tildes",t),t=O(t,e),D("xrange",t),t=B(t,e),D("stars",t),t}function A(t){return!t||"x"===t.toLowerCase()||"*"===t}function P(t,e){return t.trim().split(/\s+/).map(function(t){return F(t,e)}).join(" ")}function F(t,e){var r=e?W[ge]:W[me];return t.replace(r,function(e,r,n,i,s){D("tilde",t,e,r,n,i,s);var o;return A(r)?o="":A(n)?o=">="+r+".0.0-0 <"+(+r+1)+".0.0-0":A(i)?o=">="+r+"."+n+".0-0 <"+r+"."+(+n+1)+".0-0":s?(D("replaceTilde pr",s),"-"!==s.charAt(0)&&(s="-"+s),o=">="+r+"."+n+"."+i+s+" <"+r+"."+(+n+1)+".0-0"):o=">="+r+"."+n+"."+i+"-0"+" <"+r+"."+(+n+1)+".0-0",D("tilde return",o),o})}function R(t,e){return t.trim().split(/\s+/).map(function(t){return C(t,e)}).join(" ")}function C(t,e){var r=e?W[ke]:W[Ee];return t.replace(r,function(e,r,n,i,s){D("caret",t,e,r,n,i,s);var o;return A(r)?o="":A(n)?o=">="+r+".0.0-0 <"+(+r+1)+".0.0-0":A(i)?o="0"===r?">="+r+"."+n+".0-0 <"+r+"."+(+n+1)+".0-0":">="+r+"."+n+".0-0 <"+(+r+1)+".0.0-0":s?(D("replaceCaret pr",s),"-"!==s.charAt(0)&&(s="-"+s),o="0"===r?"0"===n?"="+r+"."+n+"."+i+s:">="+r+"."+n+"."+i+s+" <"+r+"."+(+n+1)+".0-0":">="+r+"."+n+"."+i+s+" <"+(+r+1)+".0.0-0"):o="0"===r?"0"===n?"="+r+"."+n+"."+i:">="+r+"."+n+"."+i+"-0"+" <"+r+"."+(+n+1)+".0-0":">="+r+"."+n+"."+i+"-0"+" <"+(+r+1)+".0.0-0",D("caret return",o),o})}function O(t,e){return D("replaceXRanges",t,e),t.split(/\s+/).map(function(t){return S(t,e)}).join(" ")}function S(t,e){t=t.trim();var r=e?W[_e]:W[pe];return t.replace(r,function(e,r,n,i,s,o){D("xRange",t,e,r,n,i,s,o);var a=A(n),u=a||A(i),c=u||A(s),l=c;return"="===r&&l&&(r=""),r&&l?(a&&(n=0),u&&(i=0),c&&(s=0),">"===r&&(r=">=",a||(u?(n=+n+1,i=0,s=0):c&&(i=+i+1,s=0))),e=r+n+"."+i+"."+s+"-0"):a?e="*":u?e=">="+n+".0.0-0 <"+(+n+1)+".0.0-0":c&&(e=">="+n+"."+i+".0-0 <"+n+"."+(+i+1)+".0-0"),D("xRange return",e),e})}function B(t,e){return D("replaceStars",t,e),t.trim().replace(W[Ce],"")}function V(t,e,r,n,i,s,o,a,u,c,l,f){return e=A(r)?"":A(n)?">="+r+".0.0-0":A(i)?">="+r+"."+n+".0-0":">="+e,a=A(u)?"":A(c)?"<"+(+u+1)+".0.0-0":A(l)?"<"+u+"."+(+c+1)+".0-0":f?"<="+u+"."+c+"."+l+"-"+f:"<="+a,(e+" "+a).trim()}function L(t,e){for(var r=0;t.length>r;r++)if(!t[r].test(e))return!1;return!0}function M(t,e,r){try{e=new k(e,r)}catch(n){return!1}return e.test(t)}function U(t,e,r){return t.filter(function(t){return M(t,e,r)}).sort(function(t,e){return p(t,e,r)})[0]||null}function $(t,e){try{return new k(t,e).range||"*"}catch(r){return null}}function H(t,e,r){return N(t,e,"<",r)}function I(t,e,r){return N(t,e,">",r)}function N(t,e,r,n){t=new o(t,n),e=new k(e,n);var i,s,a,u,c;switch(r){case">":i=v,s=b,a=y,u=">",c=">=";break;case"<":i=y,s=j,a=v,u="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(M(t,e,n))return!1;for(var l=0;e.set.length>l;++l){var f=e.set[l],h=null,p=null;if(f.forEach(function(t){h=h||t,p=p||t,i(t.semver,h.semver,n)?h=t:a(t.semver,p.semver,n)&&(p=t)}),h.operator===u||h.operator===c)return!1;if((!p.operator||p.operator===u)&&s(t,p.semver))return!1;if(p.operator===c&&a(t,p.semver))return!1}return!0}"object"==typeof t&&t.exports===e&&(e=t.exports=o);var D;D="object"==typeof r&&r.env&&r.env.NODE_DEBUG&&/\bsemver\b/i.test(r.env.NODE_DEBUG)?function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var W=e.re=[],q=e.src=[],z=0,G=z++;q[G]="0|[1-9]\\d*";var Q=z++;q[Q]="[0-9]+";var Z=z++;q[Z]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var J=z++;q[J]="("+q[G]+")\\."+"("+q[G]+")\\."+"("+q[G]+")";var X=z++;q[X]="("+q[Q]+")\\."+"("+q[Q]+")\\."+"("+q[Q]+")";var K=z++;q[K]="(?:"+q[G]+"|"+q[Z]+")";var Y=z++;q[Y]="(?:"+q[Q]+"|"+q[Z]+")";var te=z++;q[te]="(?:-("+q[K]+"(?:\\."+q[K]+")*))";var ee=z++;q[ee]="(?:-?("+q[Y]+"(?:\\."+q[Y]+")*))";var re=z++;q[re]="[0-9A-Za-z-]+";var ne=z++;q[ne]="(?:\\+("+q[re]+"(?:\\."+q[re]+")*))";var ie=z++,se="v?"+q[J]+q[te]+"?"+q[ne]+"?";q[ie]="^"+se+"$";var oe="[v=\\s]*"+q[X]+q[ee]+"?"+q[ne]+"?",ae=z++;q[ae]="^"+oe+"$";var ue=z++;q[ue]="((?:<|>)?=?)";var ce=z++;q[ce]=q[Q]+"|x|X|\\*";var le=z++;q[le]=q[G]+"|x|X|\\*";var fe=z++;q[fe]="[v=\\s]*("+q[le]+")"+"(?:\\.("+q[le]+")"+"(?:\\.("+q[le]+")"+"(?:("+q[te]+")"+")?)?)?";var he=z++;q[he]="[v=\\s]*("+q[ce]+")"+"(?:\\.("+q[ce]+")"+"(?:\\.("+q[ce]+")"+"(?:("+q[ee]+")"+")?)?)?";var pe=z++;q[pe]="^"+q[ue]+"\\s*"+q[fe]+"$";var _e=z++;q[_e]="^"+q[ue]+"\\s*"+q[he]+"$";var de=z++;q[de]="(?:~>?)";var ve=z++;q[ve]="(\\s*)"+q[de]+"\\s+",W[ve]=RegExp(q[ve],"g");var ye="$1~",me=z++;q[me]="^"+q[de]+q[fe]+"$";var ge=z++;q[ge]="^"+q[de]+q[he]+"$";var je=z++;q[je]="(?:\\^)";var be=z++;q[be]="(\\s*)"+q[je]+"\\s+",W[be]=RegExp(q[be],"g");var we="$1^",Ee=z++;q[Ee]="^"+q[je]+q[fe]+"$";var ke=z++;q[ke]="^"+q[je]+q[he]+"$";var xe=z++;q[xe]="^"+q[ue]+"\\s*("+oe+")$|^$";var Te=z++;q[Te]="^"+q[ue]+"\\s*("+se+")$|^$";var Ae=z++;q[Ae]="(\\s*)"+q[ue]+"\\s*("+oe+"|"+q[fe]+")",W[Ae]=RegExp(q[Ae],"g");var Pe="$1$2$3",Fe=z++;q[Fe]="^\\s*("+q[fe]+")"+"\\s+-\\s+"+"("+q[fe]+")"+"\\s*$";var Re=z++;q[Re]="^\\s*("+q[he]+")"+"\\s+-\\s+"+"("+q[he]+")"+"\\s*$";var Ce=z++;q[Ce]="(<|>)?=?\\s*\\*";for(var Oe=0;z>Oe;Oe++)D(Oe,q[Oe]),W[Oe]||(W[Oe]=RegExp(q[Oe]));e.parse=n,e.valid=i,e.clean=s,e.SemVer=o,o.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},o.prototype.inspect=function(){return'<SemVer "'+this+'">'},o.prototype.toString=function(){return this.version},o.prototype.compare=function(t){return D("SemVer.compare",this.version,this.loose,t),t instanceof o||(t=new o(t,this.loose)),this.compareMain(t)||this.comparePre(t)},o.prototype.compareMain=function(t){return t instanceof o||(t=new o(t,this.loose)),u(this.major,t.major)||u(this.minor,t.minor)||u(this.patch,t.patch)},o.prototype.comparePre=function(t){if(t instanceof o||(t=new o(t,this.loose)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.lenth&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(D("prerelease compare",e,r,n),r===undefined&&n===undefined)return 0;if(n===undefined)return 1;if(r===undefined)return-1;if(r!==n)return u(r,n)}while(++e)},o.prototype.inc=function(t){switch(t){case"major":this.major++,this.minor=-1;case"minor":this.minor++,this.patch=-1;case"patch":this.patch++,this.prerelease=[];break;case"prerelease":if(0===this.prerelease.length)this.prerelease=[0];else{for(var e=this.prerelease.length;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}break;default:throw Error("invalid increment argument: "+t)}return this.format(),this},e.inc=a,e.compareIdentifiers=u;var Se=/^[0-9]+$/;e.rcompareIdentifiers=l,e.compare=f,e.compareLoose=h,e.rcompare=p,e.sort=_,e.rsort=d,e.gt=v,e.lt=y,e.eq=m,e.neq=g,e.gte=j,e.lte=b,e.cmp=w,e.Comparator=E;var Be={};E.prototype.parse=function(t){var e=this.loose?W[xe]:W[Te],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],r[2]?(this.semver=new o(r[2],this.loose),"<"!==this.operator||this.semver.prerelease.length||(this.semver.prerelease=["0"],this.semver.format())):this.semver=Be},E.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'},E.prototype.toString=function(){return this.value},E.prototype.test=function(t){return D("Comparator.test",t,this.loose),this.semver===Be?!0:w(t,this.operator,this.semver,this.loose)},e.Range=k,k.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'},k.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range},k.prototype.toString=function(){return this.range},k.prototype.parseRange=function(t){var e=this.loose;t=t.trim(),D("range",t,e);var r=e?W[Re]:W[Fe];t=t.replace(r,V),D("hyphen replace",t),t=t.replace(W[Ae],Pe),D("comparator trim",t,W[Ae]),t=t.replace(W[ve],ye),t=t.replace(W[be],we),t=t.split(/\s+/).join(" ");var n=e?W[xe]:W[Te],i=t.split(" ").map(function(t){return T(t,e)}).join(" ").split(/\s+/);return this.loose&&(i=i.filter(function(t){return!!t.match(n)})),i=i.map(function(t){return new E(t,e)})},e.toComparators=x,k.prototype.test=function(t){if(!t)return!1;for(var e=0;this.set.length>e;e++)if(L(this.set[e],t))return!0;return!1},e.satisfies=M,e.maxSatisfying=U,e.validRange=$,e.ltr=H,e.gtr=I,e.outside=N,"function"==typeof define&&define.amd&&define(e),c._.SemVer=t.exports}),function(t){var e=t._.Fiber.extend(function(){return{name:"AbstractComponent. Override me to improve debugging",id:"abstractcomponent",depends:[],elements:{},events:{},states:{},config:{},_init:null,_eventEmitter:null,_observableEmitter:null,_isDestroyed:!1,init:function(e,r){var n,i;if(this._init=function(){},this.config={},this._eventEmitter=new t._.EventEmitter({wildcard:!1,newListener:!1,maxListeners:20}),this._observableEmitter=new t._.EventEmitter({wildcard:!1,newListener:!1,maxListeners:0}),this._state={},this.elements.root="The root HTML node of this component (automatically generated)",this.elements=o(this.elements,!0),this.events=o(this.events,!0,!0),this.states=o(this.states,!0,!0),this.depends=o(this.depends),e&&this.attach(e),r)for(n in r)if(r.hasOwnProperty(n)&&"function"!=typeof this[n]&&0!==n.indexOf("_")&&"depends"!==n&&"events"!==n&&"config"!==n)if("elements"===n)for(i in r.elements)r.elements.hasOwnProperty(i)&&this.elements._.set(i,r.elements[i]);else this.config[n]=r[n]},assign:function(t,e){if(!this.elements._.exists(t))throw Error("Invalid element: "+t+". Only elements defined in this.elements:{} may be assigned");return this.elements._.set(t,e),this},resolve:function(t,e){if(!this.depends._.exists(t))throw Error("Invalid dependency: "+t+". Only dependencies defined in this.depends:[] may be resolved");return this.depends._.set(t,e),this},destroy:function(){return this._isDestroyed=!0,this.offAny(),this.elements().root.parentNode&&this.elements().root.parentNode.removeChild(this.elements().root),this.removeAllListeners(),null},on:function(t,e){return"*"===t?this._eventEmitter.onAny(e):this._eventEmitter.on(t,e),this},off:function(t,e){return"*"===t?e?this._eventEmitter.offAny(e):this._eventEmitter.offAll(t):this._eventEmitter.off(t,e),this},onOnce:function(t,e){return this._eventEmitter.onOnce(t,e),this},setMaxListeners:function(t){return this._eventEmitter.setMaxListeners(t),this},listeners:function(t){var e=this._eventEmitter.listenersAny(),r=this._eventEmitter.listeners(t);return r.concat(e)},trigger:function(){var t=[].slice.call(arguments,0),e=t[0];if(!this.events._.exists(e))throw Error("Invalid event: "+e+". Only events defined in this.events:{} may be triggered");return this._eventEmitter.emit.apply(this._eventEmitter,t),this},bind:function(e,r,n){return"string"==typeof n?e.on(r,t.proxy(this[n],this)):e.on(r,n),this},unbind:function(t,e,r){return"string"==typeof r?t.off(e,this[r]):"function"==typeof r?t.off(e,r):t.off(e),this},wrap:function(e,r){var n=t.proxy(this[e],this),i=this;return this[e]=function(){var t=[].slice.call(arguments,0);return t.unshift(n),r.apply(i,t)},this},proxy:function(t,e){return function(){t.apply(e,arguments)}},attach:function(t){return this.assign("root",t),this},getRoot:function(){return this.elements().root},BEM:function(t,e){var r=this.id.replace(/[^A-Z0-9\-\_]/gi,"-");return t&&(r+="__"+t),e&&(r+="--"+e),r},addClass:function(t,e){var r=t.className;return i(t,e)||(r+=" "+e.replace(/[^A-Z0-9\-\_]/gi,"-"),r=r.replace(/^\s+|\s+$/g,"")),t.className=r,this},removeClass:function(t,e){var r=t.className;return r=r.replace(RegExp("(?:^|\\s)"+e.replace(l,"-")+"(?!\\S)","g"),""),r=r.replace(/^\s+|\s+$/g,""),t.className=r,this},when:function(){return t.when.apply(t,arguments)},whenAll:function(){return t.whenAll.apply(t,arguments)},load:function(e){this.elements().root&&(this.addClass(this.elements().root,this.BEM()),this.addClass(this.elements().root,this.BEM(this.elements.root)),this.addClass(this.elements().root,this.BEM(null,"loading")));for(var r,n=t.deferred(),i=this,s=[],o=this.depends._.raw(),a=this.depends(),u=0,c=o.length;c>u;u++)a[o[u]]||s.push(o[u]);return t.load.apply(t,s).then(function(n){var o,a,u=t.deferred();for(a=0,r=s.length;r>a;a++)i.depends._.set(s[a],n[a]);return o=t.when(i._init.call(i)),e&&(o=o.then(e)),o.then(function(){u.fulfill()},function(t){u.reject(t)}),u.promise}).then(function(){var t=i.elements._.raw();for(var e in t)t.hasOwnProperty(e)&&i.elements()[e]&&i.addClass(i.elements()[e],i.BEM(e));i.elements().root&&i.removeClass(i.elements().root,i.BEM(null,"loading")),n.fulfill()},function(t){i.elements().root&&(i.removeClass(i.elements().root,i.BEM(null,"loading")),i.addClass(i.elements().root,i.BEM(null,"failed"))),n.reject(t)}),n.promise},wire:function(t){function e(){return function(){}}function r(t,e){t.wrap("_init",function(r){r(),e.call(t)})}var n,i,s,o,a,u,c,l=/^[\[\]]/,f=/[\[\]]$/;if("function"==typeof t){if(t.__atomic)throw Error("Atomic Wirings must be configured (by invoking their function) and passing their return value into wire()");u={init:t}}else u=t;for(n in u)if(u.hasOwnProperty(n)){if(c=n.replace(l,"").replace(f,""),"_init"==c)throw Error('You cannot wire in "_init" as it\'s a reserved method. Please use "init" without the underscore.');if("events"!==n)if("elements"!==n)if("depends"!==n)"init"!==n&&"init"!==c?"function"!=typeof u[n]||(this[c]||(this[c]=e()),c!==n?0===n.indexOf("[")&&this.wrap(c,u[n]):this[c]=u[n]):"]init["===n?this._init=u[n]:r(this,u[n]);else for(o=0,a=u.depends.length;a>o;o++)this.depends._.add(u.depends[o]);else for(i in u.elements)this.elements[i]||this.elements._.add(i,u.elements[i]);else for(s in u.events)u.events.hasOwnProperty(s)&&this.events._.add(s,u.events[s])}return this},state:function(t,e,undefined){var r,n=[].slice.call(arguments,0),i={},s=[],o=null;if(n[1]===undefined){if(n[0]===undefined){for(r in this._state)this._state.hasOwnProperty(r)&&(i[r]=this._state[r].value);return i}if("string"==typeof n[0])return this._state[n[0]].value}if("object"==typeof n[0])for(r in n[0])if(n[0].hasOwnProperty(r)){if(!this.states._.exists(r))throw Error("Invalid state: "+r+". Only states defined in this.states:{} may be set");n[1]?(this._state[r].rev++,this._state[r].lastValue=this._state[r].value,this._state[r].value=n[0][r]):this._state[r]===undefined&&(this._state[r]={rev:0,value:n[0][r],lastValue:undefined}),s.push(r)}if("string"==typeof n[0]){if(!this.states._.exists(n[0]))throw Error("Invalid state: "+n[0]+". Only states defined in this.states:{} may be set");this._state[n[0]]===undefined?this._state[n[0]]={rev:0,value:n[1],lastValue:undefined}:(this._state[n[0]].rev++,this._state[n[0]].lastValue=this._state[n[0]].value,this._state[n[0]].value=n[1]),s.push(n[0])}for(var a=0,u=s.length;u>a;a++)o=this._state[s[a]],this._observableEmitter.emit(s[a],o.value,o.lastValue,o.rev);return s.length>0?this.render():this},observe:function(t,e){return"*"===t?this._observableEmitter.onAny(e):this._observableEmitter.on(t,e),this},unobserve:function(t,e){return"*"===t?e?this._observableEmitter.offAny(e):this._observableEmitter.offAll(t):this._observableEmitter.off(t,e),this},render:function(){return this}}});t._.AbstractComponent=e}(c),function(t){var e=new t._.EventEmitter({wildcard:!0,newListener:!1,maxListeners:20});t.augment(t.Events,{on:function(r,n){return e.on(r,n),t},off:function(r,n){return e.off(r,n),t},onAny:function(r){return e.onAny(r),t},offAny:function(r){return e.offAny(r),t},onOnce:function(r,n){return e.onOnce(r,n),t},onMany:function(r,n,i){return e.onMany(r,n,i),t},offAll:function(r){return e.offAll(r),t},setMaxListeners:function(r){return e.setMaxListeners(r),t},listeners:function(t){var r=e.listenersAny(),n=e.listeners(t);return n.concat(r)},trigger:function(){var r=[].slice.call(arguments,0);return e.emit.apply(e,r),t}})}(c),function(t){t.augment(t._,{Factory:function(e){var r={depends:!1,elements:!1,events:!1,init:!0,_init:!0,_eventEmitter:!0,_isDestroyed:!0},n=t._.AbstractComponent.extend(function(t){var n={};for(var i in e)e.hasOwnProperty(i)&&!r[i]&&(n[i]=e[i]);return n.init=function(){t.init.apply(this,arguments),"function"==typeof e.init&&(this._init=e.init)},n});return n}}),t.augment(t,{Component:function(e){return t._.Factory(e)},Wiring:function(t){return t.__atomic=!0,t}})}(c),function(t){t.augment(t,{loader:{init:function(){},register:function(e,r){t._.modules[e]=r},load:function(e){for(var r=[],n=0,i=e.length;i>n;n++){if(!t._.modules[e[n]])throw Error("Module ID is not defined: "+e[n]);r.push(t._.modules[e[n]])}return r}}})}(c),function(t,e){var r=e.Atomic,i=!1,o=!1;t.augment(t,{noConflict:function(){var t=e.Atomic;return e.Atomic=r,t},amdOptimized:function(){o=!0},load:function(){var e=t.deferred(),r=[].slice.call(arguments,0);"function"==typeof r[r.length-1]&&(e.promise.then(r[r.length-1]),r.pop()),1===r.length&&(r=r[0]),s(r)||(r=[r]);var n=null;return i?n=t.when(!0):(i=!0,n=t.when(t.loader.init()),n.then(function(){t.loader.register("Atomic",t),t.loader.register("Atomic/Component",t.Component)})),n.then(function(){return t.when(t.loader.load(r))}).then(function(t){return e.fulfill(t)},function(t){return e.reject(t)}),e.promise},proxy:function(t,e){return function(){return t.apply(e,arguments)}},throttle:function(t,e,r){var n,i,s,o=null,a=0,u=function(){a=new Date,o=null,s=t.apply(n,i)};return function(){var c=new Date;a||r!==!1||(a=c);var l=e-(c-a);return n=this,i=arguments,0>=l?(clearTimeout(o),o=null,a=c,s=t.apply(n,i)):o||(o=setTimeout(u,l)),s}},debounce:function(t,e,r){var n,i=null;return function(){var s=this,o=arguments,a=function(){i=null,r||(n=t.apply(s,o))},u=r&&!i;return clearTimeout(i),i=setTimeout(a,e),u&&(n=t.apply(s,o)),n}},expand:function(t){return function(e){var r,n=[];if("[object Array]"===Object.prototype.toString.call(e))n=e;else for(r in e)e.hasOwnProperty(r)&&n.push(e[r]);t.apply(t,n)}},keys:function(t){var e,r=[];for(e in t)t.hasOwnProperty(e)&&(r[r.length]=e);return r},deferred:function(t){var e=n();return t?(e.cast(t),undefined):e.pending()},when:function(t){return n().cast(t)},whenAll:function(t){return n().all(t)},error:function(t){var e="",r="";"object"==typeof t?(t.message?e=t.message:t.toString&&(e=""+t),t.stack?r=t.stack:t.stacktrace&&(r=t.stacktrace)):"string"==typeof t&&(e=t),console&&console.error&&console.error(e+"\n"+r)},describe:function(r,n){function i(t){var i=new t,o=[],a={};a.component=r,a.name=i.name,a.depends=i.depends._.raw(),a.events=i.events._.raw(),a.states=i.states._.raw(),o=[r+": "+i.name,"=====","BEM id: "+i.BEM(),"dependencies: "+i.depends._.raw().join(", "),"","ELEMENTS",""+i.elements,"","EVENTS",""+i.events,"","STATES",""+i.states],n&&e.console&&"function"==typeof e.console.log&&e.console.log(o.join("\n")),s.fulfill(a)}n===undefined&&(n=!0);var s=t.deferred();if("string"==typeof r)t.load([r]).then(t.expand(function(t){i(t)},t.e)).then(null,t.e);else if("function"==typeof r){var o=new r;i(o)}else i(r);return s.promise},define:function(e,r,n){if("string"!=typeof e)throw Error("you must specify an ID if you are not using a module loader system");"[object Array]"!==Object.prototype.toString.call(r)&&(n=r,r=[]);for(var i,require=function(e){if(window.console&&window.console.warn&&window.console.warn("using runtime require() is dangerous without a module loader"),!t._.modules[e])throw Error("Module not loaded: "+e);return t._.modules[e]},s={exports:{}},o=[],a=0,u=r.length;u>a;a++)if("require"!==r[a])if("module"!==r[a])if("exports"!==r[a]){if(!t._.modules[r[a]])throw Error("Module not loaded: "+r[a]);o.push(t._.modules[r[a]])}else o.push(s.exports);else o.push(s);else o.push(require);"function"==typeof n?(i=n.apply(n,o),t._.modules[e]=i?i:s.exports):t._.modules[e]=n}})}(c,t),function(t){t.augment(t,{version:"0.0.9-18-g2c8feb9"})}(c);var f="function"==typeof a&&a.amd?a:c;f("Atomic",[],function(){return c}),f("Atomic/Component",[],function(){return c.Component}),f("Atomic/Wiring",[],function(){return c.Wiring})}})(this,function(){return define});